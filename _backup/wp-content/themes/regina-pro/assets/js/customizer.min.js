!function(a){function b(){var b,d=a("#sub-accordion-panel-regina_frontpage_panel").sortable("toArray"),e=[];a.each(d,function(a,b){var d;b=b.replace("accordion-section-",""),d=c.section(b),e.push(d.params.section_id)}),b=wp.ajax.post("order_section",{sections:e,nonce:ReginaCustomizer.nonce}),b.always(function(a){wp.customize.previewer.refresh()})}var c=wp.customize,d=wp.customize.Panel.prototype.embed,e=wp.customize.Panel.prototype.isContextuallyActive,f=wp.customize.Panel.prototype.attachEvents;c.EpsilonTabs=[],c.bind("pane-contents-reflowed",function(){var b={};c.panel.each(function(a){"regina_panel"===a.params.type&&"undefined"!=typeof a.params.panel&&(void 0===b[a.params.panel]&&(b[a.params.panel]=[]),b[a.params.panel].push(a))}),a.each(b,function(b,d){var e,f=c.panel(b).sections();e=f.length>0?d.concat(f):d,e.sort(c.utils.prioritySort).reverse(),a.each(e,function(b,c){var d=a("#sub-accordion-panel-"+c.params.panel);d.children(".panel-meta").after(c.headContainer)})})}),wp.customize.Panel=wp.customize.Panel.extend({attachEvents:function(){var a=this;return"regina_panel"!==this.params.type||"undefined"==typeof this.params.panel?void f.call(this):(f.call(this),a.expanded.bind(function(b){var d=c.panel(a.params.panel);b?d.contentContainer.addClass("current-panel-parent"):d.contentContainer.removeClass("current-panel-parent")}),void a.container.find(".customize-panel-back").off("click keydown").on("click keydown",function(b){c.utils.isKeydownButNotEnterEvent(b)||(b.preventDefault(),a.expanded()&&c.panel(a.params.panel).expand())}))},embed:function(){var b=this,c=a("#sub-accordion-panel-"+this.params.panel);return"regina_panel"!==this.params.type||"undefined"==typeof this.params.panel?void d.call(this):(d.call(this),void c.append(b.headContainer))},isContextuallyActive:function(){var a=this,b=this._children("panel","section"),d=0;return"regina_panel"!==this.params.type?e.call(this):(c.panel.each(function(c){c.params.panel&&c.params.panel===a.id&&b.push(c)}),b.sort(c.utils.prioritySort),_(b).each(function(a){a.active()&&a.isContextuallyActive()&&(d+=1)}),0!==d)}}),c.section("regina_blog_category_options",function(b){b.expanded.bind(function(b){var d=ReginaCustomizer.categoryURL;b?(a.inArray(d,c.previewer.allowedUrls)||c.previewer.allowedUrls.push(d),wp.customize.previewer.previewUrl.set(d)):wp.customize.previewer.previewUrl.set(ReginaCustomizer.siteURL)})}),c.section("regina_blog_tag_options",function(b){b.expanded.bind(function(b){var d=ReginaCustomizer.tagURL;b?(a.inArray(d,c.previewer.allowedUrls)||c.previewer.allowedUrls.push(d),wp.customize.previewer.previewUrl.set(d)):wp.customize.previewer.previewUrl.set(ReginaCustomizer.siteURL)})}),c.section("regina_blog_author_options",function(b){b.expanded.bind(function(b){var d=ReginaCustomizer.authorURL;b?(a.inArray(d,c.previewer.allowedUrls)||c.previewer.allowedUrls.push(d),wp.customize.previewer.previewUrl.set(d)):wp.customize.previewer.previewUrl.set(ReginaCustomizer.siteURL)})}),c.section("regina_blog_archive_options",function(b){b.expanded.bind(function(b){var d=ReginaCustomizer.postsURL;b?(a.inArray(d,c.previewer.allowedUrls)||c.previewer.allowedUrls.push(d),wp.customize.previewer.previewUrl.set(d)):wp.customize.previewer.previewUrl.set(ReginaCustomizer.siteURL)})}),c.section("regina_blog_search_options",function(b){b.expanded.bind(function(b){var d=ReginaCustomizer.searchURL;b?(a.inArray(d,c.previewer.allowedUrls)||c.previewer.allowedUrls.push(d),wp.customize.previewer.previewUrl.set(d)):wp.customize.previewer.previewUrl.set(ReginaCustomizer.siteURL)})}),c.section("regina_single_post_section",function(b){b.expanded.bind(function(b){var d=ReginaCustomizer.postURL;b?(a.inArray(d,c.previewer.allowedUrls)||c.previewer.allowedUrls.push(d),wp.customize.previewer.previewUrl.set(d)):wp.customize.previewer.previewUrl.set(ReginaCustomizer.siteURL)})}),c.EpsilonTab=c.Control.extend({ready:function(){var b=this;b.container.find("a.epsilon-tab").click(function(c){var d=a(this).data("tab");c.preventDefault(),b.container.find("a.epsilon-tab").removeClass("active"),a(this).addClass("active"),b.toggleActiveControls(d)}),c.EpsilonTabs.push(b.id)},toggleActiveControls:function(b){var d=this,e=d.params.buttons[b].fields;_.each(d.params.fields,function(b){var d=c.control(b);void 0!==d&&(d.container.addClass("tab-element"),d.active()&&a.inArray(b,e)>=0?d.toggle(!0):d.toggle(!1))})}}),c.ReginaPluginInstall=c.Control.extend({ready:function(){var a=this,b=a.container.find("a.regina-pro-install-button");a.container.find("a.regina-pro-install-button").click(function(c){c.preventDefault(),b.addClass("updating-message"),b.html(a.params.labels[a.params.action]),"install"==a.params.action?wp.updates.installPlugin({slug:a.params.slug}):a.activePlugin(a.params.plugin_link)}),jQuery(document).on("wp-plugin-install-success",function(b,c){console.log(a),c.slug==a.params.slug&&a.activePlugin(c.activateUrl)})},activePlugin:function(a){var b=this,c=b.container.find("a.regina-pro-install-button");c.html(b.params.labels.activate),jQuery.ajax({async:!0,type:"GET",dataType:"html",url:a,success:function(){location.reload()}})}}),c.NewSection=c.Section.extend({isContextuallyActive:function(){return!0},attachEvents:function(){var b=this,c=b.container;b.headContainer.find(".accordion-section-title").replaceWith(wp.template("nav-menu-create-menu-section-title")),c.on("click",".add-new-menu-item",function(){a(this).toggleClass("open"),b.container.find(".section-content").slideToggle("slow"),b.container.find(".menu-name-field").first().focus()}),c.on("keydown","#new-section-title",function(a){13===a.which&&b.submit()}),c.on("click","#create-new-section-submit",function(a){b.submit(),a.stopPropagation(),a.preventDefault()})},submit:function(){var a,b=this,d=b.container,e=d.find(".menu-name-field").first(),f=d.find(".menu-name-field").first().val();return d.find(".spinner").addClass("is-active"),f?(a=wp.ajax.post("add_section",{title:f,nonce:ReginaCustomizer.nonce}),a.always(function(a){var b,e,g,h;"0"!==a&&(b=JSON.parse(a),e="regina_section_"+b.slug,h=ReginaCustomizer.editSectionDescription.replace("%d",b.id),g=new c.reginaSection(e,{params:{id:e,panel:"regina_frontpage_panel",slug:b.slug,section_id:b.id,title:f,description:h,type:"regina_section",customizeAction:"Customizing â–¸ Front Page Sections",priority:70}}),c.section.add(e,g),c.section(e).focus()),d.find(".spinner").removeClass("is-active")}),e.val(""),e.removeClass("invalid"),b.container.find(".add-new-menu-item").removeClass("open"),void b.container.find(".section-content").slideToggle("slow")):(e.addClass("invalid"),void e.focus())}}),c.reginaSection=c.Section.extend({isContextuallyActive:function(){return!0},ready:function(){var a=this;a.expanded.bind(function(b){b&&c.previewer.send("section-highlight",{section:a.params.slug})})}}),a.extend(c.sectionConstructor,{regina_new_section:c.NewSection,regina_section:c.reginaSection}),c.section("regina_homepage_options",function(a){a.expanded.bind(function(a){a&&c.previewer.send("section-highlight",{section:"home-slider"})})}),a.extend(c.controlConstructor,{"epsilon-tab":c.EpsilonTab,"regina-pro-install-plugin":c.ReginaPluginInstall}),c.bind("ready",function(){_.each(c.EpsilonTabs,function(a){var b=c.control(a);b.toggleActiveControls(0)}),a("#sub-accordion-panel-regina_frontpage_panel").sortable({helper:"clone",items:"> li.control-section:not(#accordion-section-regina_homepage_options)",cancel:"li.ui-sortable-handle.open",delay:150,update:function(a,c){b()}}),c.control("regina_booking_form_opions",function(a){a.setting.bind(function(a){var b={"kali-forms":["regina_kaliforms","regina_kaliforms_form_id"]};_.each(b,function(b,d){_.each(b,function(b,e){var f=c.control(b);"undefined"!=typeof f&&(d==a?f.toggle(!0):f.toggle(!1))})})})})})}(jQuery);
//# sourceMappingURL=customizer.min.js.map